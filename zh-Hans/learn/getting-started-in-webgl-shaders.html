<!DOCTYPE html>
<html class="no-js" lang="zh-Hans">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="p5.js a JS client-side library for creating graphic and interactive experiences, based on the core principles of Processing.">
    <title tabindex="1">learn | p5.js</title>
    <link rel="stylesheet" href="/assets/css/all.css?v=71f825">
    <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inconsolata&display=swap" rel="stylesheet">

    <link rel="shortcut icon" href="/../../../assets/img/favicon.ico">
    <link rel="icon" href="/../../../assets/img/favicon.ico">


    <script src="/../../../assets/js/vendor/jquery-1.12.4.min.js"></script>
    <script src="/../../../assets/js/vendor/ace-nc/ace.js"></script>
    <script src="/../../../assets/js/vendor/ace-nc/mode-javascript.js"></script>
    <script src="/../../../assets/js/vendor/prism.js"></script>
    <script src="/assets/js/init.js?v=97b4f7"></script>

    <script src="/../../../assets/js/vendor/pangu.min.js"></script>

  </head>
  <body>

    <a href="#content" class="sr-only">跳到内容</a>
    
    <!-- p5*js language buttons -->
    <div id="i18n-btn">
      <h2 id="i18n-settings" class="sr-only">语言设定</h2>
      <ul id="i18n-buttons" aria-labelledby="i18n-settings">
        <li><a href='#' lang='en' data-lang='en'>English</a></li>
        <li><a href='#' lang='es' data-lang='es'>Español</a></li>
        <li><a href='#' lang='zh-Hans' data-lang='zh-Hans'>简体中文</a></li>
        <li><a href='#' lang='ko' data-lang='ko'>한국어</a></li>
        <li><a href='#' lang='hi' data-lang='hi'>हिन्दी</a></li>
      </ul>
    </div>    <!-- .container -->
    <div class="container">

      <!-- logo -->
      <header id="lockup">
        <a href="/zh-Hans/">
          <img src="/../../../assets/img/p5js.svg" alt="p5 homepage" id="logo_image" class="logo" />
          <div id="p5_logo"></div>
        </a>
      </header>
      <!-- close logo -->

      

<style>
  .methodsList {
    font-family: monospace;
  }

  .additionalInformation {
    width: 100%;
    background-color: #dedeff;
    padding: 10px;
    margin: 30px 0;
  }

  .toc {
    width: 100%;
    background-color: #eee;
    padding: 10px;
    margin: 30px 0;
  }

  .toc h3 {
    margin-top: 15px;
  }

  .indexList {
    padding: 15px;
    background-color: whitesmoke;
  }
</style>

<div id="learn-page">

  
  <!-- site navigation -->
  <div class="column-span">
    <nav class="sidebar-menu-nav-element">
      <h2 id="menu-title" class="sr-only">网站导航</h2>
      <input class="sidebar-menu-btn" type="checkbox" id="sidebar-menu-btn" />
      <label class="sidebar-menu-icon" for="sidebar-menu-btn"><span class="sidebar-nav-icon"></span></label>
      <ul id="menu" class="sidebar-menu" aria-labelledby="menu-title">
        <li><a href="/zh-Hans/">主页</a></li>
        <li><a href="https://editor.p5js.org">编辑器</a></li>
        <li><a href="/zh-Hans/download/">下载</a></li>
        <li><a href="/zh-Hans/download/support.html">捐赠</a></li>
        <li><a href="/zh-Hans/get-started/">入门</a></li>
        <li><a href="/zh-Hans/reference/">参考文献</a></li>
        <li><a href="/zh-Hans/libraries/">程式库</a></li>
        <li><a href="/zh-Hans/learn/">学习</a></li>
        <li><a href="/zh-Hans/teach/">教学</a></li>
        <li><a href="/zh-Hans/examples/">范例</a></li>
        <li><a href="https://p5js.org/contributor-docs/#/">贡献</a></li>
        <li><a href="/zh-Hans/books/">书籍</a></li>
        <li><a href="/zh-Hans/community/">社群</a></li>
        <li><a href="https://showcase.p5js.org">案例展示</a></li>
  
      </ul>
    </nav>
  </div>

  <div class="column-span">

    <main>
      <script src="//toolness.github.io/p5.js-widget/p5-widget.js"></script>

      <iframe src="../../../assets/learn/shaderIntro/titleExample.html" width="720" height="350">
      </iframe>

      <h1>着色器入门</h1>

      <p>着色器是在图形处理单元（GPU）上运行的特殊程序，可以完成一些令人难以置信的任务。 它们利用 GPU 一次处理多个像素，使其快速且特别适用于某些任务，例如生成噪声、应用模糊滤镜或对多边形进行着色。 一开始学习着色器编程可能会让人望而却步，需要与 p5.js 的二维绘图不同的思路。本文档将概述着色器编程的基础知识，并指向其他资源。</p>

      <div class="toc">
        <h3>目录</h3>
        <ol>
          <li><a href="#setup">设置</a></li>
          <li><a href="#shadinglanguage">着色语言 (GLSL)</a></li>
          <li><a href="#uniforms">Uniforms：从草图传递数据到着色器</a></li>
          <li><a href="#conclusion">结论</a></li>          
          <li><a href="#glossary">词汇表</a></li>          
        </ol>
      </div>

      <h2 id="setup">设置</h2>

      <p>p5.js 是处理着色器的好工具，因为它处理了大部分 WebGL 的设置，使您可以专注于着色器代码本身。在开始使用着色器之前，我们必须设置画布，使其使用 p5.js WebGL 模型。
      </p>

      <pre><code class="language-javascript">
      ...
      function setup() {
        createCanvas(windowWidth, windowHeight, WEBGL);
      }
      ..
      </code></pre>

      <p>着色器程序由两部分组成，一个<strong>顶点着色器</strong>和一个<strong>片元着色器</strong>。 顶点着色器影响3D几何图形在屏幕上的绘制位置，片元着色器则负责影响颜色输出。这两个部分分别存储在不同的文件中，并通过 <a class="code">loadShader()</a>加载到p5.js中。一旦着色器被加载，它就可以在 <a class="code">draw()</a>中使用。下面的示例将展示如何在p5.js中设置基本着色器：
      </p>

      <pre><code class="language-javascript">
let myShader;

function preload() {
  // load each shader file (don't worry, we will come back to these!)
  myShader = loadShader('shader.vert', 'shader.frag');
}

function setup() {
  // the canvas has to be created with WEBGL mode
  createCanvas(windowWidth, windowHeight, WEBGL);
  describe('a simple shader example that outputs the color red')
}

function draw() {
  // shader() sets the active shader, which will be applied to what is drawn next
  shader(myShader);
  // apply the shader to a rectangle taking up the full canvas
  rect(0,0,width,height);
}
      </code></pre>

      <h2 id="shadinglanguage">着色语言 (GLSL)</h2>

      <p>现在你可能想知道我们实际上在这些着色器文件中写了什么！着色器文件是用图形库着色语言 (GLSL)编写的，它具有非常不同的语法和结构，与我们熟悉的语法和结构有很大不同。GLSL具有类似C的语法，这意味着它具有一些JavaScript中不存在的概念。</p>

      <p>首先，着色语言在类型方面要严格得多。每个你创建的变量都必须用存储的数据类型进行标记。以下是一些常见类型的列表：</p>

      <pre><code class="language-javascript">
vec2(x,y) // 由两个浮点数组成的向量
vec3(r,g,b) // 由三个浮点数组成的向量
vec4(r,g,b,a) // 由四个浮点数组成的向量
float // 带小数点的数字
int // 不带小数点的整数
sampler2D // 对纹理的引用

      </code></pre>

      <p>通常情况下，着色语言比 JavaScript 更加严格。例如，缺少分号将导致错误信息。 不能在不同类型的数字之间进行交换，如浮点数或整数。</p>

      <p>首先，让我们看一个基本的顶点着色器：</p>

      <pre><code class="language-javascript">
attribute vec3 aPosition;

void main() {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  positionVec4.xy = positionVec4.xy * 2.0 - 1.0;
  gl_Position = positionVec4;
}
</code></pre>

      <p>这个顶点着色器以一个 <em>attribute</em> 开始，p5.js 使用它来与着色器共享顶点位置信息。这个 attribute 是一个 <a class="code">vec3</a>，意味着它包含一个 x、y 和 z 值。 Attributes 是特殊的变量类型，只在顶点着色器中使用，并且通常由 p5.js 提供。</p>

      <p>所有顶点着色器都需要一个函数 <a class="code">main()</a>，在其中我们定位我们的顶点。 在这个例子中，顶点着色器重新定位我们的顶点，使着色器输出占据整个画布。在 <a class="code">main()</a> 的末尾，我们必须给 <a class="code">gl_Position</a> 赋值。</p>

      <p>如果这还不是很清楚，也不要担心。顶点着色器起着重要的作用， 但通常只负责确保我们在片段着色器中创建的内容在几何体上正确地显示。 在许多项目中，您可能会发现自己反复使用相同的顶点着色器。 另一方面，片段着色器负责着色器的颜色输出，是我们进行大量着色器编程的地方。 以下是一个非常简单的片段着色器，它只会显示红色：</p>

      <pre><code class="language-javascript">
precision mediump float;

void main() {
  vec4 myColor = vec4(1.0, 0.0, 0.0, 1.0);
  gl_FragColor = myColor;
}
</code></pre>

      <p>片段着色器以指定 float 'precision' 开始。你可以选择低精度 lowp、中精度 mediump 或高精度 highp， 不过在某些情况下，你可能会选择使用中精度或高精度。</p>

      <pre><code class="language-javascript">precision mediump float;</code></pre>

<p>和顶点着色器类似，片段着色器也需要一个 <a class="code">main()</a> 函数， 但我们不会设置 <a class="code">gl_Position</a>， 而是将颜色分配给 <a class="code">gl_FragColor</a>。</p>

<pre><code class="language-javascript">
...
vec4 myColor = vec4(1.0, 0.0, 0.0, 1.0);
gl_FragColor = myColor;
...
</code></pre>

<p>变量 <a class="code">myColor</a> 被定义为一个 <a class="code">vec4</a>， 这意味着它可以存储 4 个值。由于我们处理的是颜色，因此这四个值分别是红、绿、蓝和 alpha。 着色器不使用像我们的草图一样的 0-255 颜色，而是使用介于 0.0 和 1.0 之间的值。</p>

      <p>现在我们已经有了一个顶点着色器和一个片段着色器， 可以将它们保存到单独的文件中（shader.vert 和 shader.frag）， 并使用 <a class="code">loadShader()</a> 加载到我们的草图中。</p>

      <h2 id="uniforms">Uniforms：从草图传递数据到着色器</h2>

      <p>单独使用这样一个简单的着色器是有用的，但有时需要从 p5.js 草图向着色器传递变量。 这就是 uniforms 的作用。Uniforms 是特殊的变量，可以从草图发送到着色器。 这使得能够更好地控制着色器。例如，您可以使用 p5.js 方法 <a class="code">millis()</a>  向我们的草图传递一个“时间” uniform，以引入运动。在着色器中，uniforms 在文件顶部定义， 在 <a class="code">main()</a> 之外。在下面的片段着色器中， 我们创建了一个颜色 uniform <a class="code">myColor</a>，这将允许我们从草图中更改颜色。</p>

      <pre><code class="language-javascript">
precision mediump float;

uniform vec3 myColor;

void main() {
  // the color we have passed in as a uniform is assigned to the pixel
  gl_FragColor = vec4(myColor, 1.0);
}
      </code></pre>

      <p>回到我们的 p5.js 草图，现在可以使用 <a class="code">setUniform()</a> 发送这个颜色：</p>

      <pre><code class="language-javascript">
...
function draw() {
  shader(myShader);
  // setUniform can then be used to pass data to our shader variable, myColor
  myShader.setUniform('myColor', [1.0,0.0,0.0]); // send red as a uniform
  // apply the shader to a rectangle taking up the full canvas
  rect(0,0,width,height);
}
...
      </code></pre>

      <p>还有 <em>attributes</em>，通常用于在草图和顶点着色器之间共享关于几何体的某些数据，和 <em>varying</em> 变量，它们在顶点着色器和片段着色器之间共享数据。这使得可以在我们的片段着色器中使用位置或其他几何数据。</p>

      <pre><code class="language-javascript">
// (thank you to Adam Ferriss for the foundation of these example shaders)
// position information that is used with gl_Position
attribute vec3 aPosition;

// texture coordinates 
attribute vec2 aTexCoord;

// the varying variable will pass the texture coordinate to our fragment shader
varying vec2 vTexCoord;

void main() {
  // assign attribute to varying, so it can be used in the fragment
  vTexCoord = aTexCoord;

  vec4 positionVec4 = vec4(aPosition, 1.0);
  positionVec4.xy = positionVec4.xy * 2.0 - 1.0;
  gl_Position = positionVec4;
}
</code></pre>

      <p>现在，将纹理坐标属性分配给变量之后，我们可以在片段着色器中使用纹理坐标。下面的示例结果是蓝色和紫红色的纹理坐标可视化。</p>

      <div style="display:flex; align-items: center; justify-content: center;">
        <pre><code class="language-javascript">
precision mediump float;

varying vec2 vTexCoord;

void main() {
  // now because of the varying vTexCoord, we can access the current texture coordinate
  vec2 uv = vTexCoord;
  
  // and now these coordinates are assigned to the color output of the shader
  gl_FragColor = vec4(uv,1.0,1.0);
}
</code></pre>
        <img style="padding:30px;width:30%;" src='../../../assets/learn/basic3d/images/uv_example.png'
          alt="an illustration showing UV coordinates, the x axis in red, and the y axis in blue.">
      </div>


      <div class="additionalInformation">
        p5.js 为我们处理了许多属性和 uniforms，<a href="https://github.com/processing/p5.js/blob/374acfb44588bfd565c54d61264df197d798d121/contributor_docs/webgl_mode_architecture.md">您可以查看 p5.js 发送到着色器的所有属性列表</a>。
      </div>

      <h2 id="conclusion">结论</h2>

      <p>通过这些技能，您将能够创建一些基本的着色器，但着色器编程可以深入到无限深处，有许多着色器主题超出了本教程。在 p5.js 中，着色器可以成为创建可映射到 3D 几何体的视觉、效果甚至纹理的强大工具。
      </p>

      <p>想继续了解更多有关着色器的知识吗？请查看以下网站！</p>

      <ul class="indexList">
        <li><a href="https://thebookofshaders.com/">The Book of Shaders</a>，由 Patricio Gonzalez Vivo 和 Jen Lowe 撰写的着色器指南。</li> <li><a href="https://itp-xstory.github.io/p5js-shaders/#/">P5.js着色器</a>，由Casey Conchinha和Louise Lessél编写的着色器指南。</li> <li><a href="https://www.shadertoy.com/">Shadertoy</a>，一个庞大的在线着色器集合，这些着色器都是在浏览器编辑器中编写的。</li> <li><a href="https://github.com/aferriss/p5jsShaderExamples">p5jsShaderExamples</a>，由Adam Ferriss编写的资源集。</li>
      </ul>

      <h3>其他教程</h3>
      <p>这个教程是关于使用 p5.js 中 WebGL 基础的系列之一。以下是其他教程： </p>
      <ul class="indexList">
        <li><a href="/zh-Hans/learn/getting-started-in-webgl-coords-and-transform.html">坐标和变换</a></li>
        <li><a href="/zh-Hans/learn/getting-started-in-webgl-custom-geometry.html">在 WebGL 中创建自定义几何图形</a></li>
        <li><a href="/zh-Hans/learn/getting-started-in-webgl-appearance.html">样式和外观</a></li>
        <li>入门 Shaders （你现在处于这里）</li>
      </ul>

      <h2 id="glossary">词汇表</h2>

      <h3>着色器 Shader</h3>
      <p>可以有效地产生许多视觉效果和滤镜的特殊图形卡程序。</p>

      <h3>GLSL</h3>
      <p>图形库着色器语言（GLSL）是一种用于编写着色器的编程语言。</p>

      <h3>Uniform</h3>
      <p>从你的草图传递到着色器的变量。</p>

      <h3>矢量 Vector</h3>
      <p>一种数据类型，它存储一组数字，通常是两个、三个或四个数字，表示颜色、位置等。</p>

      <h3>浮点数 Float</h3>
      <p>一种存储浮点数的数据类型，可以有小数点。</p>

      <h3>整数 Int</h3>
      <p>一种存储整数的数据类型，没有小数。</p>

      <h3>取样器 Sampler</h3>
      <p>表示传递到着色器中的纹理的数据类型。</p>

      <h3>属性 Attribute</h3>
      <p>在 p5.js 草图中生成并在顶点着色器中提供的 GLSL 变量。对于大多数情况，这些由 p5.js 提供。</p>

      <h3>纹理 Texture</h3>
      <p>传递到着色器程序中的图像。</p>

      <h3>类型 Type</h3>
      <p>描述数据类型的特征的标签，例如 int、float、vector 等。</p>

      <h3>顶点着色器 Vertex Shader</h3>
      <p>该着色器程序的一部分负责将几何体定位在 3D 空间中。</p>

      <h3>片段着色器 Fragment Shader</h3>
      <p>该着色器程序的一部分负责每个像素输出的颜色和外观。</p>

    </main>

    
    <footer>
        <h2 class="sr-only">归功于</h2>
        <ul id="footer-menu" aria-labelledby="menu-title">   
          <li><a href="https://discourse.processing.org/c/p5js" target=_blank class="other-link">论坛</a></li>
          <li><a href="http://github.com/processing/p5.js" target=_blank class="other-link">GitHub</a></li>
          <li><a href="http://twitter.com/p5xjs" target=_blank class="other-link">Twitter</a></li>
          <li><a href="https://www.instagram.com/p5xjs/" target=_blank class="other-link">Instagram</a></li>
          <li><a href="https://discord.gg/SHQ8dH25r9" target=_blank class="other-link">Discord</a></li>
        </ul>  
        
        <p>
            p5.js 目前由<a href='http://qianqian-ye.com/' target="_blank">Qianqian Ye</a>领导，原创者为<a href='https://lauren-mccarthy.com' target="_blank">Lauren Lee McCarthy</a>。p5.js 是在<a href="https://processingfoundation.org/" target="_blank">Processing Foundation</a>和<a href="https://itp.nyu.edu/itp/" target="_blank">NYU ITP</a>的支持下由其合作社群所开发。形象及平面设计<a href="https://jereljohnson.com/" target="_blank">Jerel Johnson</a>。<a href="/zh-Hans/copyright.html">&copy; 版权信息</a>。
        </p>
    </footer>

  </div> <!-- end column-span -->

  
  <!-- outside of column for footer to go across both -->
  
  <p class="clearfix"> &nbsp; </p>
  
  <object type="image/svg+xml" data="../../../assets/img/thick-asterisk-alone.svg" id="asterisk-design-element" aria-hidden="true">
  </object>

</div><!-- end id="get-started-page"  -->

    </div> <!-- close class='container'-->

    
    <nav id="family" aria-labelledby="processing-sites-heading">
      <h2 id="processing-sites-heading" class="sr-only">Processing Sister Sites</h2>
      <ul id="processing-sites" aria-labelledby="processing-sites-heading">
        <li><a href="https://processing.org">Processing</a></li>
        <li><a class="here" href="/zh-Hans/">p5.js</a></li>
        <li><a href="https://py.processing.org/">Processing.py</a></li>
        <li><a href="https://android.processing.org/">Processing for Android</a></li>
        <li><a href="https://pi.processing.org/">Processing for Pi</a></li>
        <li><a href="https://processingfoundation.org/">Processing Foundation</a></li>
      </ul>
      <a tabindex="1" href="#content" id="skip-to-content">Skip to main content</a>
    
    
    </nav>
    <script>
    var langs = ["en","es","hi","ko","zh-Hans"];

      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-53383000-1', 'auto');
    ga('send', 'pageview');

    $(window).ready(function() {
      if (window.location.pathname !== '/' && window.location.pathname !== '/index.html') {
        $('#top').remove();
      } else {
        $('#top').show();
      }
    });
    </script>


  </body>
</html>
